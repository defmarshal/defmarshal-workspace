#!/usr/bin/env bash
# Log an event to openclaw-memory (switched from markdown)
# Usage: log-event <category> "<message>"
# Example: log-event decision "Switched to openclaw-memory for storage"

set -euo pipefail

if [ $# -lt 2 ]; then
  echo "Usage: $0 <category> \"<message>\"" >&2
  exit 1
fi

CATEGORY="$1"
MESSAGE="$2"

# Importance mapping based on category
case "$CATEGORY" in
  decision) IMPORTANCE=0.9 ;;
  learning|learnings) IMPORTANCE=0.7 ;;
  event) IMPORTANCE=0.5 ;;
  note) IMPORTANCE=0.3 ;;
  error) IMPORTANCE=0.8 ;;
  tool) IMPORTANCE=0.6 ;;
  project) IMPORTANCE=0.8 ;;
  *) IMPORTANCE=0.5 ;;
esac

# Store to openclaw-memory; suppress errors if unavailable
claw memory add "$MESSAGE" --type "$CATEGORY" --importance "$IMPORTANCE" 2>/dev/null || true

echo "Logged event to openclaw-memory"
